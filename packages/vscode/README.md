# AgentLens

> Track AI agent contributions in your codebase

![AgentLens](https://img.shields.io/visual-studio-marketplace/v/vibe-x-ai.agentlens)
![License](https://img.shields.io/github/license/alienzhou/agentlens)

## Overview

AgentLens helps you understand **who wrote what** in your codebase â€” AI or human. In the era of AI-assisted coding with Cursor, Claude Code, and other agents, it's crucial to know which code was generated by AI for better code review and maintenance.

![AgentLens](https://s17-def.ap4r.com/kos/s101/nlav112218/mengshou/agentlens.96a74eebe90f8cc4.png)

## Getting Started

### Step 1: Install the Extension

Install AgentLens from the [VS Code Marketplace](https://marketplace.visualstudio.com/items?itemName=vibe-x-ai.agentlens), or search for "AgentLens" in VS Code Extensions.

### Step 2: Connect to an AI Agent

**This step is required** to enable code tracking. AgentLens needs to connect to your AI coding assistant to capture code changes.

1. Open Command Palette (`Cmd+Shift+P` / `Ctrl+Shift+P`)
2. Run `AgentLens: Connect Agent`
3. Select your AI Agent (Cursor or Claude Code)

![Connect Agent](https://v17-def.ap4r.com/kos/s101/nlav112218/mengshou/connect-agent.png)

**For Cursor users:** Make sure to enable **"Third-party skills"** in Cursor Settings > Features for hooks to work.

### Step 3: Start Coding with Your AI Agent

Once connected, AgentLens automatically tracks all code changes made by your AI agent. You can:

- **Hover over any line** to see if it was written by AI or human
- **Check the sidebar** to see connected agents and recent AI activity
- **Use the diff view** to review AI-generated changes

## Features

### ğŸ¯ GitLens-Style Blame

Hover over any line to see contributor information:
- **AI Generated**: Code written by AI agents
- **AI Generated (Human Modified)**: AI code with human edits
- **Human Contribution**: Code written entirely by humans

![Inline Blame](https://v17-def.ap4r.com/kos/s101/nlav112218/mengshou/inline-blame.3916d683ae836108.png)

### ğŸ“Š Sidebar Views

The sidebar provides two views to help you understand AI contributions:

#### Connected Agents

Shows all supported AI agents and their connection status:
- âœ… **Connected**: Agent is connected and tracking code changes
- âš ï¸ **Detected**: Agent is installed but not connected
- âŒ **Not Detected**: Agent is not installed on your system

> **Tip:** Click on an agent to connect or disconnect.

#### Recent Activity

Displays recent code changes made by AI agents:
- Browse changes grouped by time
- Click to open the changed file
- Use the diff icon to view before/after changes

> **Note:** This view requires at least one agent to be connected. If empty, use `AgentLens: Connect Agent` command first.

### ğŸ”Œ Multi-Agent Support

Works with popular AI coding assistants:
- **Cursor** - via Third-party Hooks
- **Claude Code** - via Hooks system
- More coming soon...

### âš™ï¸ Configuration

```json
{
  "agentLens.matching.timeWindowDays": 3,
  "agentLens.matching.lengthTolerance": 0.5,
  "agentLens.autoCleanup.enabled": true,
  "agentLens.autoCleanup.retentionDays": 7,
  "agentLens.developerMode": false
}
```

| Setting | Description | Default |
|---------|-------------|---------|
| `timeWindowDays` | Time window for matching agent records | 3 |
| `lengthTolerance` | Content length tolerance for filtering | 0.5 |
| `autoCleanup.enabled` | Enable automatic cleanup of old data | true |
| `autoCleanup.retentionDays` | Days to retain data files | 7 |
| `developerMode` | Show extra debug information | false |

## How It Works

AgentLens uses **4-level filtering with Levenshtein similarity matching**:

```
Level 1: File Path Filter     (100 records â†’ 30 records)
    â†“
Level 2: Time Window Filter   (30 records â†’ 15 records)
    â†“
Level 3: Content Length Filter (15 records â†’ 5 records)
    â†“
Level 4: Levenshtein Matching  (5 candidates â†’ best match)
```

**Classification Thresholds**:
- â‰¥ 90% similarity â†’ **AI Generated**
- 70-90% similarity â†’ **AI Generated (Human Modified)**
- < 70% similarity â†’ **Human Contribution**

## Commands

| Command | Description |
|---------|-------------|
| `AgentLens: Connect Agent` | Connect to an AI agent (required for tracking) |
| `AgentLens: Disconnect Agent` | Disconnect from an AI agent |
| `AgentLens: Show Agent Status` | Display agent connection status |
| `AgentLens: Show Blame` | Show contributor info for current line |
| `AgentLens: Report Matching Issue` | Report a matching problem |
| `AgentLens: Cleanup Old Data` | Manually clean up old data files |

## Requirements

- VS Code 1.85.0 or higher
- Git repository
- AI coding assistant (Cursor or Claude Code)

## Troubleshooting

### Sidebar shows no activity

Make sure you have connected to an AI agent:
1. Run `AgentLens: Connect Agent` from Command Palette
2. Select your AI agent
3. Start using your AI agent to generate code

### Cursor hooks not working

Ensure "Third-party skills" is enabled in Cursor:
1. Open Cursor Settings
2. Go to Features
3. Enable "Third-party skills"

### Blame shows "Human Contribution" for AI code

This can happen when:
- The agent was not connected when the code was written
- The code was heavily modified after AI generation
- The time window has expired (default: 3 days)

## Links

- [GitHub Repository](https://github.com/alienzhou/agentlens)
- [Issue Tracker](https://github.com/alienzhou/agentlens/issues)
- [Changelog](https://github.com/alienzhou/agentlens/blob/main/CHANGELOG.md)

## License

MIT License - see [LICENSE](https://github.com/alienzhou/agentlens/blob/main/LICENSE)
